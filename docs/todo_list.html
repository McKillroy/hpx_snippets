

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Work Doc : Current ToDo List &mdash; HPX Cookbook 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> HPX Cookbook
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Section 1 : About this Document and the associated Git Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Section 2 : Introduction to the Problem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#part-i-moore-s-law-and-the-free-lunch-is-over-problem">Part I : Moore’s Law and “The Free Lunch is Over” problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#part-ii-some-thoughts-on-concurrency-parallelism-and-distributed-computing">Part II : Some thoughts on Concurrency, Parallelism and Distributed Computing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="intro.html#a-concurrency">A. Concurrency</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#b-parallelism">B. Parallelism</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#c-distributed-computing">C. Distributed Computing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scalability.html">Section 3 : Scalability, Amdahls Law and the USL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scalability.html#scalability">Scalability</a></li>
<li class="toctree-l2"><a class="reference internal" href="scalability.html#amdahls-law">Amdahls Law</a></li>
<li class="toctree-l2"><a class="reference internal" href="scalability.html#the-universal-scalability-law-usl">The Universal Scalability Law “USL”</a></li>
<li class="toctree-l2"><a class="reference internal" href="scalability.html#consequences-of-the-usl-for-writing-your-application">Consequences of the USL for writing your application</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hpx_basics.html">Section 4 : HPX Basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hpx_basics.html#introduction-to-hpx">Introduction to HPX</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpx_basics.html#what-can-hpx-do-for-you">What can HPX do for you?</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpx_basics.html#what-can-hpx-not-do-for-you">What can HPX NOT do for you</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpx_basics.html#how-does-it-work">How does it work?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hpx_basics.html#parallelization">Parallelization</a></li>
<li class="toctree-l3"><a class="reference internal" href="hpx_basics.html#concurrency">Concurrency</a></li>
<li class="toctree-l3"><a class="reference internal" href="hpx_basics.html#distribution">Distribution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Section 5: Concepts needed to understand and leverage HPX</a><ul>
<li class="toctree-l2"><a class="reference internal" href="concepts.html#general-programming-concepts">General Programming Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="concepts.html#c-concepts">C++ Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="concepts.html#hpx-concepts">HPX Concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hpx_parallel_execution.html">Section 6: HPX Parallel Task Execution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hpx_parallel_execution.html#calls-into-the-runtime">Calls into the runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpx_parallel_execution.html#executors-and-execution-policies">Executors and Execution Policies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hpx_concurrency_management.html">Section 7: HPX Concurrency Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hpx_concurrency_management.html#futures">Futures</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpx_concurrency_management.html#synchronous-and-asynchronous-calls">Synchronous and Asynchronous Calls</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hpx_distributed_computing.html">Section 8: HPX Distributed Computing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hpx_distributed_computing.html#locality">Locality</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpx_distributed_computing.html#component">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpx_distributed_computing.html#action">Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpx_distributed_computing.html#hpx-serialization-and-transport">HPX Serialization and Transport</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">Section 42 : A collection of HPX Recipes, HowTos and Drafts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="recipes.html#hpx-action-and-component-macros">HPX Action and Component Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="recipes.html#hpx-other">HPX Other</a></li>
<li class="toctree-l2"><a class="reference internal" href="recipes.html#drafts">Drafts</a></li>
<li class="toctree-l2"><a class="reference internal" href="recipes.html#general-c">General C++</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">HPX Cookbook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Work Doc : Current ToDo List</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/todo_list.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="work-doc-current-todo-list">
<h1><a class="toc-backref" href="#id1">Work Doc : Current ToDo List</a><a class="headerlink" href="#work-doc-current-todo-list" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#work-doc-current-todo-list" id="id1">Work Doc : Current ToDo List</a></p>
<ul>
<li><p><a class="reference internal" href="#open-questions" id="id2">Open Questions</a></p></li>
<li><p><a class="reference internal" href="#check-and-then-add-to-tips" id="id3">Check and then Add to Tips</a></p></li>
<li><p><a class="reference internal" href="#caveats-gotchas-and-quirks" id="id4">Caveats, gotchas and quirks</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="open-questions">
<h2><a class="toc-backref" href="#id2">Open Questions</a><a class="headerlink" href="#open-questions" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Threads</dt><dd><ul class="simple">
<li><p>How can I get the Ids of all HPX worker threads?</p></li>
<li><p>How can I run code on a specific worker thread?</p></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li><p>Can I run local non-action functions directly with hpx?</p></li>
<li><p>launch policies: How do I start an async action and force HPX to immediately start executing ( real time priority? )</p></li>
</ul>
<dl>
<dt>What exactly do the Macros do? what is the underlying mechanic?</dt><dd><div class="line-block">
<div class="line">See also <a class="reference internal" href="macros_for_components_and_actions.html"><span class="doc">HPX Macros for Components and Actions</span></a> and</div>
<div class="line"><a class="reference internal" href="hpx_macrodoc_for_doxygen.html"><span class="doc">HPX Macro Documentation for later use in in-source / Doxygen Docs</span></a></div>
</div>
</dd>
</dl>
<ul>
<li><dl class="simple">
<dt>Which of HPX includes do I need when?</dt><dd><p>One include to rule them all: <code class="docutils literal notranslate"><span class="pre">&lt;hpx/hpx.hpp&gt;</span></code> - how to narrow scope?</p>
</dd>
</dl>
</li>
<li><p>Recommended build methods and examples.</p>
<blockquote>
<div><ul class="simple">
<li><p>VS, VSCODE, CMake, vcpkg, …</p></li>
<li><p>HPX CMake commands explained: add_hpx_executable, add_hpx_library - These are almost entirely undocumented.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>## Fades out - wait for changes
add_hpx_executable
add_hpx_component ## fragl auch f. actions
hpx_setup_target: Use this.</p>
<ul class="simple">
<li><p>iterate over threads for initialization:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[06:25:39] &lt;Yorlik&gt; NVM - found it: hpx::async&lt;agns::game::Controller::start_action&gt;(hpx::launch::sync, gcId);
[06:29:29] &lt;Yorlik&gt; Argh - crap thats wrong ... fork maybe?
[07:59:14] &lt;jbjnr_&gt; Yorlik: fork will suspend the current task and immediately switch to the new one - but this would only work for a local action. If you wanted to do it remotely, you need to look at direct_Action
[08:03:57] &lt;Yorlik&gt; How would I start a task immediately but async - is there a way to control that ?
[08:07:11] &lt;jbjnr_&gt; fork policy should work, (I tend to use a high priority task and am prepared to wait)
[08:08:22] &lt;Yorlik&gt; But you said fork suspends the current task. i want it to be non blocking but guarentee to start immediately
[08:08:30] &lt;Yorlik&gt; Or asap
[08:09:35] &lt;jbjnr_&gt; &quot;non blocking but guarentee to start immediately&quot; - that&#39;s a contradiction unless you spawn a completely new worker thread to launch it on
[08:09:57] &lt;jbjnr_&gt; can you reserve a core for a special thread pool for these realtime tasks?
[08:10:12] &lt;jbjnr_&gt; (one at a time), or more threads in the pool if you need multiple
[08:10:21] &lt;jbjnr_&gt; cores^
[08:10:33] &lt;Yorlik&gt; I am starting this out of hpx_main and its essentially a task running for the lifetime of the program
[08:11:01] &lt;jbjnr_&gt; Then the best thing to do would be create aseparate thread pool with 1 core in it and only run that task on that pool
[08:11:31] &lt;Yorlik&gt; OK. Is there a way to iterate of my worker threads to initialize thread local objects?
[08:11:32] &lt;jbjnr_&gt; then normal tasks will use the &#39;default&#39; thread pool and your special task will be in it&#39;s own sandbox
[08:12:29] &lt;Yorlik&gt; Makes sense. My default pool would have a lua engine in each OS thread. I&#39;d like to initialize all of them at start. How could I iterate over them?
[08:12:38] &lt;jbjnr_&gt; scroll down to the end of here - https://github.com/STEllAR-GROUP/hpx/blob/master/tests/unit/resource/named_pool_executor.cpp does this help you?
[08:12:41] &lt;Yorlik&gt; And start an init  task on each
[08:13:02] &lt;jbjnr_&gt; aha. That&#39;s slightly different
[08:13:55] &lt;Yorlik&gt; i just want to call a function at startup on each thread which created the static thread local lua engine
[08:14:09] &lt;jbjnr_&gt; yup. let me think a moment
[08:14:17] &lt;jbjnr_&gt; I&#39;m looking for an example to help you
[08:14:18] &lt;Yorlik&gt; We don&#39;t keep state in the lua engines - they just run one off tasks that store data on the C++ side
[08:14:36] &lt;Yorlik&gt; So we can run any gameobject message handlers on any lua state
[08:16:41] &lt;jbjnr_&gt; if you are running this from main(), then just loop over the number of threads and async spawn a task for each lua engine/interpreter, if no other taks are running then each core will take one task automagically
[08:17:11] &lt;Yorlik&gt; That I could do.
[08:17:22] &lt;Yorlik&gt; I have a separate init function that would just do it
[08:17:53] &lt;jbjnr_&gt; to be 100% certain that nothing else runs there, create a pool name &quot;lua&quot; or something and allocate N cores to it, then start N lua tasks on that pol. All other taks will go on the &quot;default&quot; pool
[08:18:13] &lt;jbjnr_&gt; the default pool must have at least one core assigned to it
[08:18:49] &lt;Yorlik&gt; How would I pin a task to a thread?
[08:19:01] &lt;jbjnr_&gt; we plan to allow pools to coexist on the same cores (so on 1 4 core machine you could have a 4 core lua pool and a 1 core default pool and 1 core would have to run two worker threads, but we haven&#39;t enabled it yet)
[08:19:36] &lt;jbjnr_&gt; look https://github.com/STEllAR-GROUP/hpx/blob/master/examples/resource_partitioner/simple_resource_partitioner.cpp#L89
[08:19:36] &lt;Yorlik&gt; That might for example make sense for pipelining scenarios
[08:19:48] &lt;jbjnr_&gt; step 1, create a lua pol (this example creates an MPI pool)
[08:20:01] &lt;jbjnr_&gt; step 2, create an executor that is bound to that pools
[08:20:14] &lt;jbjnr_&gt; step 3, async(executor, task)
[08:20:26] &lt;jbjnr_&gt; step 1 must be done at startup, steps 2,3 can be done any time
[08:21:00] &lt;Yorlik&gt; So I can pin to a pool, but not a thread in that pool? Would I need single thread pools then?
[08:22:18] &lt;jbjnr_&gt; you could create N thread pools each with one core, but if the task never suspends, one it starts runing it will stay on the core it started on, so it is sort of pinned by default.
[08:22:41] &lt;jbjnr_&gt; we do support launching on a single core within a pool, but there isn&#39;t an example and the API is &#39;in flux&#39;
[08:22:56] &lt;jbjnr_&gt; so it would be better to use N pools like the first example I showed you
[08:23:18] &lt;Yorlik&gt; So I cannot iterate over the threads within a pool but just have several single threded pools I could then iterate over?
[08:23:24] &lt;jbjnr_&gt; (named_pool_executor test)
[08:23:39] &lt;jbjnr_&gt; yes.
[08:23:52] &lt;Yorlik&gt; Which would spool any scheduling ifc.
[08:23:59] &lt;Yorlik&gt; ifc=ofc
[08:24:07] &lt;Yorlik&gt; err -- spool = spoil
[08:24:11] &lt;jbjnr_&gt; it is possible to iterate over threads, but the API is a bit broken and you&#39;re better off using N pools and iterating over them with an executor for each
[08:24:25] &lt;Yorlik&gt; But what about my scheduling then?
[08:24:41] &lt;Yorlik&gt; I still would like to just give a tsk to the pool and not care where its running
[08:25:01] &lt;Yorlik&gt; I simply want a guaranteed initialization at start.
[08:25:18] &lt;jbjnr_&gt; but you said these lua tasks run forever, so no other tasks can run there anyway?
[08:25:30] &lt;Yorlik&gt; Nono
[08:25:35] &lt;Yorlik&gt; The lua tasks are short
[08:25:49] &lt;Yorlik&gt; But the task doing the main event loop runs forever
[08:26:00] &lt;Yorlik&gt; It does the task construction
[08:26:14] &lt;jbjnr_&gt; video chat?
[08:26:16] &lt;Yorlik&gt; Like batching 100 objects for update into a task
[08:26:20] &lt;Yorlik&gt; Sure
[08:26:25] &lt;jbjnr_&gt; appear.in?
[08:26:27] &lt;Yorlik&gt; Ya
</pre></div>
</div>
<hr class="docutils" />
<p>action = struct {} -</p>
<p>Registrierung -</p>
</div>
<div class="section" id="check-and-then-add-to-tips">
<h2><a class="toc-backref" href="#id3">Check and then Add to Tips</a><a class="headerlink" href="#check-and-then-add-to-tips" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>It seems when using hpx_add_executable it also takes care of proper installation setup</p></li>
</ul>
</div>
<div class="section" id="caveats-gotchas-and-quirks">
<h2><a class="toc-backref" href="#id4">Caveats, gotchas and quirks</a><a class="headerlink" href="#caveats-gotchas-and-quirks" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>Confusing function and action names in macro parameters</p></li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Yorlik, https://github.com/McKillroy/hpx_snippets

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>